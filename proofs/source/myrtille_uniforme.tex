\input{./proofs/source/preambule.tex}
\usepackage{tkz-base}
\usepackage{algorithm}
\usepackage{algorithmic}
\setlength\parindent{0pt}

% \usepackage{graphicx,txfonts}
       

\sloppy                  

\pgfplotsset{compat=1.16}

\begin{document}


\setmathfont{Latin Modern Math}
\setmathfont[range={\mathscr,\mathbfscr}]{XITS Math}


\textbf{Lemme: } \mintinline{cpp}{Myrtille} est \((\gamma, p)\)-accurate pour l'estimation d'un décile sur la distribution uniforme sur \([0,1]\) avec
\begin{align*}
    \alpha & : \beta \in [0,1] \mapsto  8\left( \log k + \log 2/\beta \right)/\varepsilon\\
    p & = \inf_{\beta \in [0,1]}\left( \sum_{k = 0}^{\alpha(\beta)} \binom{n/10}{k}\left( \gamma \right)^k (1 - \gamma)^{n-k} \times \sum_{k = 0}^{\alpha(\beta)} \binom{9n/10}{k}\left( \gamma \right)^k (1 - \gamma)^{n-k} + \beta \right)
\end{align*}



\textit{Démonstration:} Soit \(x \in \R^n\) et \(\gamma, \beta \in [0,1]^2\). On suppose \(x\) triée par ordre croissant pour faciliter les notations.\\

\begin{itemize}[label=•]
    \item On pose \(\alpha = 8\left( \log k + \log 2/\beta \right)/\varepsilon\). On sait que \mintinline{cpp}{AboveThreshold} est alors \((\alpha, \beta)\)-accurate. On en déduit que, 
    \[
        \mathbb P \left( \mathcal M(x)_i \in [x_{i n/10 -\alpha},x_{i n/10 +\alpha}] \right) \geq 1 - \beta
    \]
    \item Posons alors \((d_i)_i\) les déciles de \(x\). On note que 
    \begin{align*}
         &\ \mathbb P\left(  \mathcal M(x)_i \in [d_i - \gamma, d_i + \gamma] \right) \\
        \geq &\ \mathbb P \left([x_{i n/10 -\alpha},x_{i n/10 +\alpha}] \subset [d_i - \gamma, d_i + \gamma]\ \wedge\  \mathcal M(x)_i \in [x_{i n/10 -\alpha},x_{i n/10 +\alpha}]  \right)
    \end{align*}

    Or, 
    \begin{align*}
        \mathbb{P}(A \cap B) & = 1 - \mathbb{P}(A^c \cup B^c) \geq 1 - \mathbb{P}(A^c) -  \mathbb{P}(B^c) = \mathbb{P}(A) + \mathbb{P}(B) - 1
    \end{align*}

    Ainsi, 
    \begin{align*}
        &\  \mathbb P\left(  \mathcal M(x)_i \in [d_i - \gamma, d_i + \gamma] \right) \\
       \geq &\ \mathbb P \left([x_{i n/10 -\alpha},x_{i n/10 +\alpha}] \subset [d_i - \gamma, d_i + \gamma] \right) + \mathbb P\left( \mathcal M(x)_i \in [x_{in/10 -\alpha},x_{i n/10 +\alpha}]  \right) - 1\\
       \geq &\ \mathbb P \left([x_{i n/10 -\alpha},x_{i n/10 +\alpha}] \subset [d_i - \gamma, d_i + \gamma] \right) - \beta
   \end{align*}
   \item Minorons enfin \(\mathbb P \left([x_{i n/10 -\alpha},x_{i n/10 +\alpha}] \subset [d_i - \gamma, d_i + \gamma] \right)\) pour conclure!\\
   
    L'événement dont nous essayons de minorer la probabilité est l'événement \(A\) = ``au moins \(\alpha\) valeurs, parmi celles plus petites que \(d_i\), sont dans \([d_i - \gamma,d_i]\) de longueur \(\gamma\) et au moins \(\alpha\) valeurs, parmi celles plus grandes que \(d_i\), sont dans \([d_i, d_i + \gamma]\)''. Ainsi,
    \begin{align*}
        & \ \mathbb P \left([x_{i\times n/10 -\alpha},x_{i\times n/10 +\alpha}] \subset [d_i - \gamma, d_i + \gamma] \right)\\
        = &\ 1 - \sum_{k = 0}^{\alpha} \binom{n/10}{k}\left( \gamma \right)^k (1 - \gamma)^{n-k} \times \sum_{k = 0}^{\alpha} \binom{9n/10}{k}\left( \gamma \right)^k (1 - \gamma)^{n-k}
    \end{align*}
\end{itemize}


Finalement,
\[
    \mathbb P\left(  \mathcal M(x)_i \in [d_i - \gamma, d_i + \gamma] \right) \geq 1 - \sum_{k = 0}^{\alpha} \binom{n/10}{k}\left( \gamma \right)^k (1 - \gamma)^{n-k} \times \sum_{k = 0}^{\alpha} \binom{9n/10}{k}\left( \gamma \right)^k (1 - \gamma)^{n-k} - \beta  
\]


\vspace*{5pt}
\textbf{Théorème: } Pour tout \(\beta \in [0,1]\) et tout \(\gamma \in \R_+\), \mintinline{cpp}{Myrtille} a une erreur quadratique moyenne inférieur à \(\sqrt{9}\gamma\) sur la distribution uniforme sur \([0,1]\) avec une probabilité au moins \(\left( 1 - p) \right)^9\) pour 
\begin{align*}
    \alpha & : \beta \in [0,1] \mapsto  8\left( \log k + \log 2/\beta \right)/\varepsilon\\
    p & = \inf_{\beta \in [0,1]}\left( \sum_{k = 0}^{\alpha(\beta)} \binom{n/10}{k}\left( \gamma \right)^k (1 - \gamma)^{n-k} \times \sum_{k = 0}^{\alpha(\beta)} \binom{9n/10}{k}\left( \gamma \right)^k (1 - \gamma)^{n-k} + \beta \right)
\end{align*}

\textit{Démonstration:} C'est un corollaire direct du lemme précédent. 


\end{document}